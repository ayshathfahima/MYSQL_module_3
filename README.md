# MYSQL_module_3


5-Sorting and Grouping data
Insert 10 rows into both tables, as given below. Create a table named Country with fields: Id Country_name Population Area Create another table named Persons with fields: Id Fname Lname Population Rating Country_Id Country_name 1. Write an SQL query to print the first three characters of Country_name from the Country table. 2. Write an SQL query to concatenate first name and last name from Persons table. 3. Write an SQL query to count the number of unique country names from Persons table. 4. Write a query to print the maximum population from the Country table. 5. Write a query to print the minimum population from Persons table. 6. Insert 2 new rows to the Persons table making the Lname NULL. Then write another query to count Lname from Persons table. 7. Write a query to find the number of rows in the Persons table. 8. Write an SQL query to show the population of the Country table for the first 3 rows. (Hint: Use LIMIT) 9. Write a query to print 3 random rows of countries. (Hint: Use rand() function and LIMIT) 10. List all persons ordered by their rating in descending order. 11. Find the total population for each country in the Persons table. 12. Find countries in the Persons table with a total population greater than 50,000 13. List the total number of persons and average rating for each country, but only for countries with more than 2 persons, ordered by the average rating in ascending order.

6-Joins and Union
Consider the Country table and Persons table that you created earlier and perform the following: (1)Perform inner join, Left join, and Right join on the tables. (2)List all distinct country names from both the Country and Persons tables. (3)List all country names from both the Country and Persons tables, including duplicates. (4)Round the ratings of all persons to the nearest integer in the Persons table.

7-Functions
Consider the Country table and Persons table that you created earlier and perform the following: 1. Add a new column called DOB in Persons table with data type as Date. 2. Write a user-defined function to calculate age using DOB. 3. Write a select query to fetch the Age of all persons using the function that has been created. 4. Find the length of each country name in the Country table. 5. Extract the first three characters of each country's name in the Country table. 6. Convert all country names to uppercase and lowercase in the Country table.

8-Subqueries and Views
Consider the Country table and Persons table that you created earlier and perform the following: 1. Find the number of persons in each country. 2. Find the number of persons in each country sorted from high to low. 3. Find out an average rating for Persons in respective countries if the average is greater than 3.0 4. Find the countries with the same rating as the USA. (Use Subqueries) 5. Select all countries whose population is greater than the average population of all nations. Create a database named Product and create a table called Customer with the following fields in the Product database: Customer_Id - Make PRIMARY KEY First_name Last_name Email Phone_no Address City State Zip_code Country 1. Create a view named customer_info for the Customer table that displays Customer’s Full name and email address. Then perform the SELECT operation for the customer_info view. 2. Create a view named US_Customers that displays customers located in the US. 3. Create another view named Customer_details with columns full name(Combine first_name and last_name), email, phone_no, and state. 4. Update phone numbers of customers who live in California for Customer_details view. 5. Count the number of customers in each state and show only states with more than 5 customers. 6. Write a query that will return the number of customers in each state, based on the "state" column in the "customer_details" view. 7. Write a query that returns all the columns from the "customer_details" view, sorted by the "state" column in ascending order.
9-Stored Procedures
Consider the Worker table with following fields: Worker_Id INT FirstName CHAR(25), LastName CHAR(25), Salary INT(15), JoiningDate DATETIME, Department CHAR(25)) 1. Create a stored procedure that takes in IN parameters for all the columns in the Worker table and adds a new record to the table and then invokes the procedure call. 2. Write stored procedure takes in an IN parameter for WORKER_ID and an OUT parameter for SALARY. It should retrieve the salary of the worker with the given ID and returns it in the p_salary parameter. Then make the procedure call. 3. Create a stored procedure that takes in IN parameters for WORKER_ID and DEPARTMENT. It should update the department of the worker with the given ID. Then make a procedure call. 4. Write a stored procedure that takes in an IN parameter for DEPARTMENT and an OUT parameter for p_workerCount. It should retrieve the number of workers in the given department and returns it in the p_workerCount parameter. Make procedure call. 5. Write a stored procedure that takes in an IN parameter for DEPARTMENT and an OUT parameter for p_avgSalary. It should retrieve the average salary of all workers in the given department and returns it in the p_avgSalary parameter and call the procedure.


10-Triggers
1. Create a table named teachers with fields id, name, subject, experience and salary and insert 8 rows. 2. Create a before insert trigger named before_insert_teacher that will raise an error “salary cannot be negative” if the salary inserted to the table is less than zero. 3. Create an after insert trigger named after_insert_teacher that inserts a row with teacher_id,action, timestamp to a table called teacher_log when a new entry gets inserted to the teacher table. tecaher_id -> column of teacher table, action -> the trigger action, timestamp -> time at which the new row has got inserted. 4. Create a before delete trigger that will raise an error when you try to delete a row that has experience greater than 10 years. 5. Create an after delete trigger that will insert a row to teacher_log table when that row is deleted from teacher table.
